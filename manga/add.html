
<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <title>Th√™m truy·ªán m·ªõi</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f8f8f8; }
    label { display: block; margin-top: 10px; }
    input, textarea { width: 100%; padding: 8px; margin-top: 4px; }
    button { margin-top: 15px; padding: 10px 20px; }
    .chapter-block { border: 1px solid #ccc; padding: 10px; margin-top: 10px; background: #fff; }
  </style>
</head>
<body>
  <h1>Th√™m truy·ªán m·ªõi</h1>

  <label>ID truy·ªán</label>
  <input type="text" id="id">

  <label>T√™n truy·ªán</label>
  <input type="text" id="name">

  <label>M√¥ t·∫£</label>
  <textarea id="description"></textarea>

  <label>Th·ªÉ lo·∫°i (c√°ch nhau b·∫±ng d·∫•u ph·∫©y)</label>
  <input type="text" id="genre">

  <label>ƒê∆∞·ªùng d·∫´n ·∫£nh b√¨a (VD: assets/truyen/cover.jpg)</label>
  <input type="text" id="cover">

  <h2>Danh s√°ch ch∆∞∆°ng</h2>
  <div id="chapters"></div>
  <button onclick="addChapter()">‚ûï Th√™m ch∆∞∆°ng</button>

  <br><br>
  <button onclick="exportJSON()">üíæ Xu·∫•t truyen-moi.json</button>

  <script>
    let chapters = [];

    function addChapter() {
      const chapIndex = chapters.length;
      const container = document.getElementById("chapters");

      const div = document.createElement("div");
      div.className = "chapter-block";
      div.innerHTML = `
        <label>T√™n ch∆∞∆°ng</label>
        <input type="text" id="chap-name-${chapIndex}">
        <label>ID ch∆∞∆°ng (VD: chap1, chap2)</label>
        <input type="text" id="chap-id-${chapIndex}">
        <label>·∫¢nh ch∆∞∆°ng (m·ªói d√≤ng 1 ·∫£nh)</label>
        <textarea id="chap-imgs-${chapIndex}"></textarea>
      `;
      container.appendChild(div);
    }

    function exportJSON() {
      const id = document.getElementById("id").value.trim();
      const name = document.getElementById("name").value.trim();
      const description = document.getElementById("description").value.trim();
      const genre = document.getElementById("genre").value.trim();
      const cover = document.getElementById("cover").value.trim();

      const chapterElems = document.querySelectorAll(".chapter-block");
      const chapterData = [];

      chapterElems.forEach((div, i) => {
        const chapId = document.getElementById(`chap-id-${i}`).value.trim();
        const chapName = document.getElementById(`chap-name-${i}`).value.trim();
        const imgs = document.getElementById(`chap-imgs-${i}`).value.trim().split("\n").filter(x => x);
        chapterData.push({
          id: chapId,
          name: chapName,
          images: imgs
        });
      });

      const story = {
        id, name, description, genre, cover, chapters: chapterData
      };

      const blob = new Blob([JSON.stringify(story, null, 2)], { type: "application/json" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "truyen-moi.json";
      a.click();
      URL.revokeObjectURL(url);
    }
  </script>
</body>
</html>
